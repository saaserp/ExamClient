<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html><head><title>Writing Beans (Advanced) - Betwixt</title><style type="text/css" media="all">
          @import url("../style/maven-base.css");
          
          @import url("../style/maven-theme.css");@import url("../style/project.css");</style><link rel="stylesheet" href="../style/print.css" type="text/css" media="print"></link><meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1"></meta><meta name="author" content="James Strachan"></meta><meta name="email" content="jstrachan@apache.org"></meta></head><body class="composite"><div id="banner"><a href="http://jakarta.apache.org" id="organizationLogo"><img alt="The Apache Software Foundation" src="http://jakarta.apache.org/images/original-jakarta-logo.gif"></img></a><a href="http://jakarta.apache.org/commons/betwixt/" id="projectLogo"><img alt="Betwixt" src="../images/logo.png"></img></a><div class="clear"><hr></hr></div></div><div id="breadcrumbs"><div class="xleft">Last published: 21 December 2006
                <span class="separator">|</span> Doc for  0.8
                </div><div class="xright">
        
        <a href="http://jakarta.apache.org/commons/" class="externalLink" title="External Link">Jakarta Commons</a>
      </div><div class="clear"><hr></hr></div></div><div id="leftColumn"><div id="navcolumn"><div id="menuCommons_Betwixt"><h5>Commons Betwixt</h5><ul><li class="none"><a href="../index.html">Overview</a></li><li class="none"><a href="../faq.html">FAQ</a></li><li class="none"><a href="../apidocs/index.html">Javadoc</a></li><li class="none"><a href="../mail-lists.html">Mailing lists</a></li><li class="none"><a href="../team-list.html">Team</a></li><li class="none"><a href="../community.html">Community</a></li><li class="none"><a href="../powered.html">Powered By</a></li><li class="none"><a href="../tasks.html">Tasks</a></li><li class="none"><a href="http://svn.apache.org/viewcvs.cgi/jakarta/commons/proper/betwixt/trunk/" class="externalLink" title="External Link">View SVN</a></li><li class="none"><a href="http://svn.apache.org/repos/asf/jakarta/commons/proper/betwixt/" class="externalLink" title="External Link">SVN</a></li></ul></div><div id="menuUser_guide"><h5>User guide</h5><ul><li class="none"><a href="../guide/start.html">Getting Started</a></li><li class="none"><a href="../guide/binding.html">Binding Beans</a></li><li class="none"><a href="../guide/derived.html">Derived Bindings</a></li><li class="none"><strong><a href="../guide/writing.html">Writing Beans(Advanced)</a></strong></li><li class="none"><a href="../guide/output.html">Outputting The Results</a></li><li class="none"><a href="../guide/reading.html">Reading Beans(Advanced)</a></li><li class="none"><a href="../guide/integration.html">Integrating</a></li><li class="none"><a href="../guide/examples.html">Examples</a></li><li class="none"><a href="../guide/tutorial.html">Tutorial</a></li></ul></div><div id="menuRelease_Documentation"><h5>Release Documentation</h5><ul><li class="none"><a href="http://jakarta.apache.org/commons/betwixt/betwixt-0.7" class="externalLink" title="External Link">0.7</a></li><li class="none"><a href="http://jakarta.apache.org/commons/betwixt/betwixt-0.6" class="externalLink" title="External Link">0.6</a></li><li class="none"><a href="http://jakarta.apache.org/commons/betwixt/betwixt-0.5" class="externalLink" title="External Link">0.5</a></li></ul></div><div id="menuProject_Documentation"><h5>Project Documentation</h5><ul><li class="none"><a href="../index.html">About</a></li><li class="collapsed"><a href="../project-info.html">Project Info</a></li><li class="collapsed"><a href="../maven-reports.html">Project Reports</a></li><li class="none"><a href="http://jakarta.apache.org/commons/charter.html" class="externalLink" title="External Link">Development Process</a></li></ul></div><div id="menuCommons"><h5>Commons</h5><ul><li class="none"><a href="http://jakarta.apache.org/commons/" class="externalLink" title="External Link">Home</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/components.html" class="externalLink" title="External Link">Components</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/sandbox/index.html" class="externalLink" title="External Link">Sandbox</a></li><li class="collapsed"><a href="http://jakarta.apache.org/commons/dormant/index.html" class="externalLink" title="External Link">Dormant</a></li><li class="none"><a href="http://jakarta.apache.org/commons/volunteering.html" class="externalLink" title="External Link">Volunteering</a></li><li class="none"><a href="http://jakarta.apache.org/commons/patches.html" class="externalLink" title="External Link">Contributing Patches</a></li><li class="none"><a href="http://jakarta.apache.org/commons/building.html" class="externalLink" title="External Link">Building Components</a></li><li class="none"><a href="http://jakarta.apache.org/commons/releases/index.html" class="externalLink" title="External Link">Releasing Components</a></li><li class="none"><a href="http://wiki.apache.org/jakarta-commons/FrontPage" class="externalLink" title="External Link">Wiki</a></li></ul></div><div id="legend"><h5>Legend</h5><ul><li class="externalLink">External Link</li><li class="newWindow">Opens in a new window</li></ul></div><a href="http://maven.apache.org/" title="Built by Maven" id="poweredBy"><img alt="Built by Maven" src="../images/logos/maven-feather.png"></img></a></div></div><div id="bodyColumn"><div class="contentBox"><div class="section"><a name="Writing_Beans__Advanced_"></a><h2>Writing Beans (Advanced)</h2>
        <div class="subsection"><a name="Writing_DynaBeans"></a><h3>Writing DynaBeans</h3>
            <p>
A <strong>DynaBean</strong> is a pseudo-bean whose properties may differ between instances of the same Class.
Pseudo-introspection of the available properties uses a pseudo-class of type DynaClass.
For more details see <a href="http://jakarta.apache.org/commons/beanutils/index.html" class="externalLink" title="External Link">BeanUtils</a>.
                </p>
            <p>
Betwixt now supports the (correct) writing of objects implementing DynaBean. Rather than using standard
introspection for these objects, <code>Betwixt</code> now interrogates the DynaClass. Using .betwixt files
with DynaBeans is not yet supported. The special behaviour of DynaBean classes will be overridden when a
.betwixt file is present.
                </p>
    </div>
        <div class="subsection"><a name="Writing_Entity_Beans"></a><h3>Writing Entity Beans</h3>
            <p>
Entity beans are a kind of Enterprise Java Bean. For more details see the
<a href="http://java.sun.com/j2ee/" class="externalLink" title="External Link">J2EE</a> specification. They are a common way to persist data.
When dealing with an entity bean, you usually deal with the remote interface rather than the
concrete implementation. There is no guarantee that the class presented by the container will be
the class your created to provide the bean's functionality. 
Indeed, <code>Proxy</code> implementations are 
one common way in which the remote interfaces are implemented. 
        </p>
            <p>
This causes some difficulties for Betwixt. Betwixt (by default) will introspect the actual implementation
presented by the container.
Fortunately, the normalization mechanism described <a href="binding.html#Introspection_And_Normalization">here</a> 
can be used to allow betwixt to introspect the actual interface (rather than the implementation).
        </p>
            <p>
There are two different strategies that can be used. The first is to create a special 
<code>ClassNormalizer</code> which extracts an interface from a <code>Proxy</code>.
(Thanks to Christoph Gaffga for suggesting this.)
For example:
        </p>
<code><pre>
        XMLIntrospector introspector = ...;
        introspector.setClassNormalizer( new ClassNormalizer() {
                public Class normalize( Class clazz ) {
                    if ( Proxy.isProxyClass(clazz) &amp;&amp; clazz.getInterfaces().length &gt;0 ) {
                        return clazz.getInterfaces()[0];
                    }
                    return clazz;
                }
            });
</pre></code>
            <p>
Of course, this will only work if your J2EE implementation uses <code>Proxy</code> classes to implement
it's Entity Beans.
        </p>
            <p>
The alternative is to use a <code>ListedClassNormalizer</code> and register all remote interfaces.
For example:
        </p>
<code><pre>
        XMLIntrospector introspector = ...;
        ListedClassNormalizer classNormalizer = new ListedClassNormalizer();
        classNormalizer.addSubstitution( MyRemoteInterfaceOne.class );
        classNormalizer.addSubstitution( MyRemoteInterfaceTwo.class );
        ...
        introspector.setClassNormalizer( classNormalizer );
</pre></code>
    </div>
        <div class="subsection"><a name="Suppressing_The_Expression_Of_Attributes"></a><h3>Suppressing The Expression Of Attributes</h3>
            <p>
Sometimes there are certain values for some attributes which should result in
the attribute not being expressed at all. A typical use case is the requirement
for null property values to result in the absence of the mapped attributes
(as opposed to their expression with an empty value).
        </p>
            <p>
Betwixt allows this behaviour to be customized through the setting of the
<code>ValueSuppressionStrategy</code> property of the writer's
<code>BindingConfiguration</code> to an appropriate 
<code>ValueSuppressionStrategy</code> implementation.
        </p>
            <p>
By default, Betwixt suppresses empty attributes.
        </p>
    </div>
    		<div class="subsection"><a name="Suppressing_The_Expression_Of_Elements_At_Bind_Type"></a><h3>Suppressing The Expression Of Elements At Bind Type</h3>
    				<p>
The expression of elements can be suppressed at bind time in a similar fashion. 
This is particularly useful when particular property values must not to expressed.
This can help to prevent complete tree traversal when using tools such as Hibernate. 
Again, a custom <code>ValueSuppressionStrategy</code> implementation should be created.
    			</p>
    	</div>
</div><div class="section"><a name="Pretty_Print"></a><h2>Pretty Print</h2>
    <div class="subsection"><a name="Pretty_Printing"></a><h3>Pretty Printing</h3>
        <p>
<code>BeanWriter</code> supports pretty printing. When pretty printing, extra white space will be inserted
with the aim of making the xml produced more readable by humans. Pretty printing is off by default.
Call <code>enablePrettyPrint</code> to switch it on. For example:
        </p>

    <div class="source"><pre>
    BeanWriter writer = ...
    ...
    writer.enablePrettyPrinting();
</pre></div>
  
    </div>
    <div class="subsection"><a name="Setting_Initial_Indent"></a><h3>Setting Initial Indent</h3>
        <p>
Pretty printing indents elements so that the xml can be read more easily. The number of indentations
for the root element defaults to one. Some users may prefer this to start at zero. This value is configurable through 
the <code>initialIndentLevel</code> property of <code>BeanWriter</code>. For example
        </p>

    <div class="source"><pre>
    BeanWriter writer = ...
    ...
    writer.setInitialIndentLevel(0);
</pre></div>
  
    </div>
</div></div></div><div class="clear"><hr></hr></div><div id="footer"><div class="xright">© 2002-2006, The Apache Software Foundation</div><div class="clear"><hr></hr></div></div></body></html>